This now works. I am making a commit
After merging with Harry's code

